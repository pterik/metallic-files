/******************************************************************************/
/*            Generated by IBExpert 2021.9.4.1 09.09.2021 20:57:20            */
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES WIN1251;

SET CLIENTLIB 'C:\Windows\System32\GDS32.DLL';

CREATE DATABASE 'D:\Projects\GitHub\metallic-files\branches\Metallica\Database\DATABASE.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET WIN1251;



/******************************************************************************/
/*                                 Generators                                 */
/******************************************************************************/

CREATE GENERATOR GEN_GRID_SHOW_ID;
SET GENERATOR GEN_GRID_SHOW_ID TO 638;

CREATE GENERATOR GEN_PRICES_TREE_ID;
SET GENERATOR GEN_PRICES_TREE_ID TO 230;

CREATE GENERATOR GEN_PRICE_HEADERS_ID;
SET GENERATOR GEN_PRICE_HEADERS_ID TO 245;

CREATE GENERATOR GEN_PRICE_LINES_ID;
SET GENERATOR GEN_PRICE_LINES_ID TO 40365;

CREATE GENERATOR GEN_PRICE_VALUES_ID;
SET GENERATOR GEN_PRICE_VALUES_ID TO 1;

CREATE GENERATOR GEN_TRUSTLEVEL_ID;
SET GENERATOR GEN_TRUSTLEVEL_ID TO 0;



/******************************************************************************/
/*                                   Tables                                   */
/******************************************************************************/



CREATE TABLE CALL_SHABLONE (
    CS_SHORTCUT  SMALLINT NOT NULL,
    CS_SHABLONE  VARCHAR(100) CHARACTER SET NONE
);

CREATE TABLE COMPANY (
    CM_ID         INTEGER NOT NULL,
    CM_NAME       VARCHAR(100),
    CM_OWNER      INTEGER DEFAULT 1 NOT NULL,
    CM_TRUST      INTEGER DEFAULT 1 NOT NULL,
    CM_CITY       VARCHAR(100) DEFAULT '' NOT NULL COLLATE WIN1251_UA,
    CM_COMMENT    VARCHAR(255),
    CM_ISCLOSED   INTEGER DEFAULT 0,
    CM_HYPERLINK  VARCHAR(1000),
    CM_BUSINESS   VARCHAR(100) NOT NULL
);

CREATE TABLE COMPANYNAMETYPES (
    CNT_ID    INTEGER NOT NULL,
    CNT_NAME  VARCHAR(50) NOT NULL,
    CNT_CNTR  INTEGER
);

CREATE TABLE CONTACTS (
    CN_ID                 INTEGER NOT NULL,
    CN_MANAGER            INTEGER NOT NULL,
    CN_OWNER              INTEGER NOT NULL,
    CN_COMPANY            INTEGER NOT NULL,
    CN_PERIODICITY        INTEGER DEFAULT 0,
    CN_CONTACTER          VARCHAR(200),
    CN_COMMENT            VARCHAR(255),
    CN_COMMENT_CLOSE      VARCHAR(255),
    CN_JOBTYPE            INTEGER,
    CN_JOBCOMMENT         VARCHAR(255) NOT NULL,
    CN_LAST_JOB           INTEGER DEFAULT null,
    CN_LAST_JOB_DATE      DATE DEFAULT null,
    CN_NEXT_JOB_DATE      DATE,
    CN_ISCLOSED           INTEGER DEFAULT 0 NOT NULL,
    CN_CLOSED_BY_MANAGER  INTEGER
);

CREATE TABLE CONTACTVIEWS (
    CN_USER    INTEGER NOT NULL,
    CN_VIEWER  INTEGER NOT NULL
);

CREATE TABLE DUAL (
    DUMMY  CHAR(1) NOT NULL
);

CREATE TABLE GRID_SHOW (
    GS_ID             INTEGER NOT NULL,
    GS_TREEID         INTEGER,
    GS_FIELD          VARCHAR(50) COLLATE WIN1251_UA,
    GS_HEADER         VARCHAR(50) COLLATE WIN1251_UA,
    GS_SHOW           SMALLINT DEFAULT 1 NOT NULL,
    GS_SIZE           INTEGER default 50 NOT NULL,
    GS_DISPLAYFORMAT  VARCHAR(20) DEFAULT null,
    GS_ORDERBY        INTEGER DEFAULT 0
);

CREATE TABLE IBE$PARAMS_HISTORY (
    IBE$PH_PROCEDURE_NAME  VARCHAR(67) CHARACTER SET UNICODE_FSS NOT NULL,
    IBE$PH_PARAMS          BLOB SUB_TYPE 0 SEGMENT SIZE 80
);

CREATE TABLE JOBS (
    J_ID             INTEGER NOT NULL,
    J_COMPANYID      INTEGER NOT NULL,
    J_USERID         INTEGER NOT NULL,
    J_OWNERID        INTEGER NOT NULL,
    J_CLOSEDBY       INTEGER,
    J_CONTACT_ID     INTEGER DEFAULT null,
    J_DATE           DATE,
    J_COMMENT        VARCHAR(255),
    J_COMMENT_CLOSE  VARCHAR(255),
    J_TYPE           INTEGER NOT NULL,
    J_ISCLOSED       SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE JOBSFORBOSS (
    JB_JOBID     INTEGER NOT NULL,
    JB_VIEWERID  INTEGER NOT NULL
);

CREATE TABLE JOBTYPE (
    JT_ID    INTEGER NOT NULL,
    JT_NAME  VARCHAR(50) CHARACTER SET NONE
);

CREATE TABLE PERIODICITY (
    PR_ID       INTEGER NOT NULL,
    PR_NAME     VARCHAR(255) NOT NULL,
    PR_COMMENT  VARCHAR(255)
);

CREATE TABLE PHONES (
    PH_ID         NUMERIC(18,0) NOT NULL,
    PH_COMMENT    VARCHAR(100),
    PH_DATEBEGIN  DATE,
    PH_ISCLOSED   SMALLINT DEFAULT 0 NOT NULL,
    PH_DATEEND    DATE,
    PH_CLOSEDBY   INTEGER
);

CREATE TABLE PHONES_COMPANIES (
    PC_PHID        NUMERIC(18,0) NOT NULL,
    PC_UID         INTEGER NOT NULL,
    PC_COMPANY     INTEGER NOT NULL,
    PC_DATEUPDATE  DATE
);

CREATE TABLE PRICE_HEADERS (
    PH_ID           INTEGER NOT NULL,
    PH_COMPANYID    INTEGER NOT NULL,
    PH_ISFINISHED   SMALLINT DEFAULT 0 NOT NULL,
    PH_DATE_INSERT  TIMESTAMP,
    PH_ISCLOSED     SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE PRICE_LINES (
    PL_ID           INTEGER NOT NULL,
    PL_HEADERID     INTEGER NOT NULL,
    PL_TREEID       INTEGER,
    PL_PRICE        FLOAT DEFAULT 0 NOT NULL,
    PL_VALUE1       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE2       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE3       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE4       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE5       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE6       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE7       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE8       VARCHAR(200) COLLATE WIN1251_UA,
    PL_VALUE9       VARCHAR(200) COLLATE WIN1251_UA,
    PL_ORDERBY      INTEGER NOT NULL,
    PL_DATE_UPDATE  TIMESTAMP,
    PL_ISCLOSED     SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE PRICES_TREE (
    PT_ID        INTEGER NOT NULL,
    PT_PARENTID  INTEGER DEFAULT null,
    PT_LEVEL     SMALLINT DEFAULT 1 NOT NULL,
    PT_VALUE     VARCHAR(100) DEFAULT ' ' NOT NULL COLLATE WIN1251_UA,
    PT_DATE      DATE,
    PT_ORDERBY   INTEGER DEFAULT 1 NOT NULL,
    PT_ISCLOSED  SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE SETTINGS (
    ST_ID       INTEGER NOT NULL,
    ST_NAME     VARCHAR(100),
    ST_VALUE    VARCHAR(100),
    ST_COMMENT  VARCHAR(255)
);

CREATE TABLE TRUSTLEVEL (
    TL_ID        INTEGER NOT NULL,
    TL_NAME      VARCHAR(100),
    TL_COLOR     INTEGER DEFAULT 0 NOT NULL,
    TL_LEVEL     INTEGER,
    TL_ISCLOSED  INTEGER DEFAULT 0,
    TL_ORDERBY   INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE USERS (
    U_ID             INTEGER NOT NULL,
    U_LOGIN          VARCHAR(30) CHARACTER SET NONE,
    U_PASSWORD       VARCHAR(10) DEFAULT null,
    U_ISBOSS         INTEGER DEFAULT 0,
    U_FIO            VARCHAR(50) DEFAULT null,
    U_COMMENT        VARCHAR(50) DEFAULT null,
    U_EDIT_OWN_JOBS  SMALLINT DEFAULT 0 NOT NULL,
    U_EDIT_PRICES    SMALLINT DEFAULT 0 NOT NULL,
    U_ISCLOSED       SMALLINT DEFAULT 0 NOT NULL
);

CREATE TABLE USERSFORBOSS (
    UB_USERID    INTEGER NOT NULL,
    UB_VIEWERID  INTEGER NOT NULL
);



/******************************************************************************/
/*                             Check constraints                              */
/******************************************************************************/

ALTER TABLE COMPANY ADD CONSTRAINT CHK1_COMPANY_CLOSED check ((CM_ISCLOSED=0) OR (CM_ISCLOSED=1));
ALTER TABLE USERS ADD CONSTRAINT CHK1_USERS_CLOSED check ((U_ISCLOSED=1) or (U_ISCLOSED=0));
ALTER TABLE USERSFORBOSS ADD CONSTRAINT CHKITSELFS_USERSFORBOSS check (UB_USERID<>UB_VIEWERID);
ALTER TABLE CONTACTS ADD CONSTRAINT CHK1_CONTACTS_CLOSED check ((CN_ISCLOSED=0) OR (CN_ISCLOSED=1));
ALTER TABLE USERS ADD CONSTRAINT CHK_USERS_EDIT_OWN_JOBS check ((U_EDIT_OWN_JOBS=0) OR (U_EDIT_OWN_JOBS=1));
ALTER TABLE PHONES ADD CONSTRAINT CHK2_PHONES check ((PH_ISCLOSED=0) OR (PH_ISCLOSED=1));
ALTER TABLE DUAL ADD CONSTRAINT CHK1_DUAL check (DUMMY ='X');
ALTER TABLE CALL_SHABLONE ADD CONSTRAINT CHK1_CALL_SHABLONE check ((CS_SHORTCUT>47 and CS_SHORTCUT<58) or (CS_SHORTCUT>64 and CS_SHORTCUT<91)
);
ALTER TABLE PRICES_TREE ADD CONSTRAINT CHK2_PRICES_TREE check (
PT_ORDERBY>0);
ALTER TABLE PRICE_HEADERS ADD CONSTRAINT CHK1_PRICE_HEADERS check ((PH_ISCLOSED=0) or (PH_ISCLOSED=1));
ALTER TABLE GRID_SHOW ADD CONSTRAINT CHK1_GRID_SHOW check ((GS_SHOW=0) OR (GS_SHOW=1));
ALTER TABLE PRICES_TREE ADD CONSTRAINT CHK1_PRICES_TREE check ((PT_ISCLOSED=0) OR (PT_ISCLOSED=1));
ALTER TABLE PRICE_LINES ADD CONSTRAINT CHK1_PRICE_LINES check ((PL_ISCLOSED=0) OR (PL_ISCLOSED=1));
ALTER TABLE USERS ADD CONSTRAINT CHK1_USERS_EDIT_PRICES check ((U_EDIT_PRICES=0) OR (U_EDIT_PRICES=1));
ALTER TABLE PRICES_TREE ADD CONSTRAINT CHK3_PRICES_TREE check ((PT_LEVEL=1) OR (PT_LEVEL=2));
ALTER TABLE COMPANY ADD CONSTRAINT CHK1_COMPANY check (CM_ID>0);
ALTER TABLE PRICES_TREE ADD CONSTRAINT CHK4_PRICES_TREE check (PT_ID>0);
ALTER TABLE PRICE_HEADERS ADD CONSTRAINT CHK2_PRICE_HEADERS check ((PH_ISFINISHED=0) or (PH_ISFINISHED=1));
ALTER TABLE GRID_SHOW ADD CONSTRAINT CHK3_GRID_SHOW check (GS_SIZE>0);
ALTER TABLE GRID_SHOW ADD CONSTRAINT CHK2_GRID_SHOW check (GS_ORDERBY>=-4);
ALTER TABLE TRUSTLEVEL ADD CONSTRAINT CHK1_TRUSTLEVEL_CLOSED check ((TL_ISCLOSED=0) OR (TL_ISCLOSED=1));
ALTER TABLE TRUSTLEVEL ADD CONSTRAINT CHK1_TRUSTLEVEL check (TL_ID>0);
ALTER TABLE TRUSTLEVEL ADD CONSTRAINT CHK2_TRUSTLEVEL check (TL_COLOR>0);


/******************************************************************************/
/*                             Unique constraints                             */
/******************************************************************************/

ALTER TABLE CALL_SHABLONE ADD CONSTRAINT UNQ1_CALL_SHABLONE UNIQUE (CS_SHORTCUT);
ALTER TABLE SETTINGS ADD CONSTRAINT UNQ1_SETTINGS UNIQUE (ST_NAME);


/******************************************************************************/
/*                                Primary keys                                */
/******************************************************************************/

ALTER TABLE COMPANY ADD CONSTRAINT PK_COMPANY PRIMARY KEY (CM_ID);
ALTER TABLE COMPANYNAMETYPES ADD PRIMARY KEY (CNT_ID);
ALTER TABLE CONTACTS ADD CONSTRAINT PK_CONTACTS PRIMARY KEY (CN_ID)
USING INDEX PK_CONTACT_ID;
ALTER TABLE DUAL ADD CONSTRAINT PK_DUAL PRIMARY KEY (DUMMY);
ALTER TABLE GRID_SHOW ADD CONSTRAINT PK_GRID_SHOW PRIMARY KEY (GS_ID);
ALTER TABLE IBE$PARAMS_HISTORY ADD PRIMARY KEY (IBE$PH_PROCEDURE_NAME);
ALTER TABLE JOBS ADD CONSTRAINT PK_JOBS PRIMARY KEY (J_ID);
ALTER TABLE JOBTYPE ADD CONSTRAINT PK_JT_JTID PRIMARY KEY (JT_ID);
ALTER TABLE PERIODICITY ADD CONSTRAINT PK_PERIODICITY PRIMARY KEY (PR_ID);
ALTER TABLE PHONES_COMPANIES ADD CONSTRAINT PK_PH_COMP_PH_ID_COMP PRIMARY KEY (PC_PHID, PC_COMPANY);
ALTER TABLE PRICES_TREE ADD CONSTRAINT PK_PRICES_TREE PRIMARY KEY (PT_ID);
ALTER TABLE PRICE_HEADERS ADD CONSTRAINT PK_PRICE_HEADERS PRIMARY KEY (PH_ID);
ALTER TABLE PRICE_LINES ADD CONSTRAINT PK_PRICE_LINES PRIMARY KEY (PL_ID);
ALTER TABLE SETTINGS ADD PRIMARY KEY (ST_ID);
ALTER TABLE TRUSTLEVEL ADD CONSTRAINT PK_TRUSTLEVEL PRIMARY KEY (TL_ID);
ALTER TABLE USERS ADD CONSTRAINT U_ID_PRIMARY PRIMARY KEY (U_ID);
ALTER TABLE USERSFORBOSS ADD CONSTRAINT PK_USERSFORBOSS PRIMARY KEY (UB_USERID, UB_VIEWERID);


/******************************************************************************/
/*                                Foreign keys                                */
/******************************************************************************/

ALTER TABLE COMPANY ADD CONSTRAINT FK_COMPANY_1 FOREIGN KEY (CM_TRUST) REFERENCES TRUSTLEVEL (TL_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE COMPANY ADD CONSTRAINT FK_COMPANY_OWNER FOREIGN KEY (CM_OWNER) REFERENCES USERS (U_ID) ON UPDATE CASCADE;
ALTER TABLE CONTACTS ADD CONSTRAINT FK_CONTACTS_CLOSEDBY FOREIGN KEY (CN_CLOSED_BY_MANAGER) REFERENCES USERS (U_ID);
ALTER TABLE CONTACTS ADD CONSTRAINT FK_CONTACTS_COMPANY FOREIGN KEY (CN_COMPANY) REFERENCES COMPANY (CM_ID);
ALTER TABLE CONTACTS ADD CONSTRAINT FK_CONTACTS_JOB FOREIGN KEY (CN_LAST_JOB) REFERENCES JOBS (J_ID);
ALTER TABLE CONTACTS ADD CONSTRAINT FK_CONTACTS_OWNER FOREIGN KEY (CN_OWNER) REFERENCES USERS (U_ID);
ALTER TABLE CONTACTS ADD CONSTRAINT FK_CONTACTS_PERIOD FOREIGN KEY (CN_PERIODICITY) REFERENCES PERIODICITY (PR_ID);
ALTER TABLE CONTACTVIEWS ADD CONSTRAINT FK_CV_USERID FOREIGN KEY (CN_USER) REFERENCES USERS (U_ID)
  USING INDEX FK_CONTACTVIEWS_CN_USER;
ALTER TABLE CONTACTVIEWS ADD CONSTRAINT FK_CV_VIEWERID FOREIGN KEY (CN_VIEWER) REFERENCES USERS (U_ID)
  USING INDEX FK_CONTACTVIEWS_CN_VIEWER;
ALTER TABLE GRID_SHOW ADD CONSTRAINT FK_GRID_SHOW_1 FOREIGN KEY (GS_TREEID) REFERENCES PRICES_TREE (PT_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE JOBS ADD CONSTRAINT FK_JOBS_CONTRACT FOREIGN KEY (J_CONTACT_ID) REFERENCES CONTACTS (CN_ID) ON DELETE SET NULL;
ALTER TABLE JOBSFORBOSS ADD CONSTRAINT FK_JB_VIEWERID FOREIGN KEY (JB_VIEWERID) REFERENCES USERS (U_ID);
ALTER TABLE PHONES_COMPANIES ADD CONSTRAINT FK_PC_COMPANYID FOREIGN KEY (PC_COMPANY) REFERENCES COMPANY (CM_ID);
ALTER TABLE PHONES_COMPANIES ADD CONSTRAINT FK_PC_USERID FOREIGN KEY (PC_UID) REFERENCES USERS (U_ID);
ALTER TABLE PRICES_TREE ADD CONSTRAINT FK_PRICES_TREE_2 FOREIGN KEY (PT_PARENTID) REFERENCES PRICES_TREE (PT_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE PRICE_HEADERS ADD CONSTRAINT FK_PRICE_HEADERS_1 FOREIGN KEY (PH_COMPANYID) REFERENCES COMPANY (CM_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE PRICE_LINES ADD CONSTRAINT FK_PRICE_LINES_1 FOREIGN KEY (PL_HEADERID) REFERENCES PRICE_HEADERS (PH_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE PRICE_LINES ADD CONSTRAINT FK_PRICE_LINES_2 FOREIGN KEY (PL_TREEID) REFERENCES PRICES_TREE (PT_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE USERSFORBOSS ADD CONSTRAINT FK_UB_USERID FOREIGN KEY (UB_USERID) REFERENCES USERS (U_ID);
ALTER TABLE USERSFORBOSS ADD CONSTRAINT FK_UB_VIEWER_ID FOREIGN KEY (UB_VIEWERID) REFERENCES USERS (U_ID);


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/

CREATE UNIQUE INDEX FK_PHONES_COMP_USER ON PHONES (PH_ID);
CREATE INDEX PRICES_TREE_IDX1 ON PRICES_TREE (PT_PARENTID, PT_ID);
CREATE INDEX PRICES_TREE_ISCLOSED ON PRICES_TREE (PT_ISCLOSED);
CREATE INDEX PRICE_HEADERS_ISCLOSED ON PRICE_HEADERS (PH_ISCLOSED);
CREATE INDEX PRICE_LINES_IDX1 ON PRICE_LINES (PL_TREEID, PL_ISCLOSED);


/******************************************************************************/
/*                                  Triggers                                  */
/******************************************************************************/



SET TERM ^ ;



/******************************************************************************/
/*                            Triggers for tables                             */
/******************************************************************************/



/* Trigger: GRID_SHOW_BI */
CREATE TRIGGER GRID_SHOW_BI FOR GRID_SHOW
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.GS_ID IS NULL) THEN
    NEW.GS_ID = GEN_ID(GEN_GRID_SHOW_ID,1);
END
^

/* Trigger: PRICES_TREE_BI */
CREATE TRIGGER PRICES_TREE_BI FOR PRICES_TREE
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.PT_ID IS NULL) THEN
    NEW.PT_ID = GEN_ID(GEN_PRICES_TREE_ID,1);
END
^

/* Trigger: PRICE_HEADERS_BI */
CREATE TRIGGER PRICE_HEADERS_BI FOR PRICE_HEADERS
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.PH_ID IS NULL) THEN
    NEW.PH_ID = GEN_ID(GEN_PRICE_HEADERS_ID,1);
END
^

/* Trigger: PRICE_LINES_BI */
CREATE TRIGGER PRICE_LINES_BI FOR PRICE_LINES
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.PL_ID IS NULL) THEN
    NEW.PL_ID = GEN_ID(GEN_PRICE_LINES_ID,1);
END
^

/* Trigger: TRUSTLEVEL_BI */
CREATE TRIGGER TRUSTLEVEL_BI FOR TRUSTLEVEL
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.TL_ID IS NULL) THEN
    NEW.TL_ID = GEN_ID(GEN_TRUSTLEVEL_ID,1);
END
^
SET TERM ; ^



/******************************************************************************/
/*                                Descriptions                                */
/******************************************************************************/

COMMENT ON TABLE COMPANY IS
'Список компаний
Сокращеное название CM';

COMMENT ON TABLE CONTACTVIEWS IS
'Список тех, кто может просмтаривать конакты (все задания по ним)
Сокращенное название CV';

COMMENT ON TABLE JOBSFORBOSS IS
'Список работ, которые открыты и видны другим пользователям
Сокращенное название таблицы JB';

COMMENT ON TABLE JOBTYPE IS
'Типы работ которые нужно выполнять, шаблон в комментарии
и дополнительные визуальные элементы на форме.
Сокращенное название JOBTYPE';

COMMENT ON TABLE PHONES IS
'Справочник телефонов
Сокращенное название PH';

COMMENT ON TABLE PHONES_COMPANIES IS
'Телефоны компаний
Сокращенное название PC';

COMMENT ON TABLE PRICE_HEADERS IS
'Заголовки прайсов';

COMMENT ON TABLE PRICE_LINES IS
'Хранит значения строк по каждому прайсу и каждой компании';

COMMENT ON TABLE USERS IS
'Таблица пользователей системы
Сокращенное название U';

COMMENT ON TABLE USERSFORBOSS IS
'Список пользователей, которым выданы права на просмотр данных
других пользователей.
Сокращенное название UB';



/******************************************************************************/
/*                            Fields descriptions                             */
/******************************************************************************/

COMMENT ON COLUMN CALL_SHABLONE.CS_SHORTCUT IS
'Код буквы для горячей клавиши шаблона. Ограничение: код от 32 до 127';

COMMENT ON COLUMN CALL_SHABLONE.CS_SHABLONE IS
'Текст шаблона вставляемой по горячей клавише';

COMMENT ON COLUMN COMPANY.CM_NAME IS
'Наименование компании';

COMMENT ON COLUMN COMPANY.CM_OWNER IS
'Ответственный менеджер за данную компанию';

COMMENT ON COLUMN COMPANY.CM_CITY IS
'Город в котором находится компания';

COMMENT ON COLUMN COMPANY.CM_COMMENT IS
'Комментарий о компании';

COMMENT ON COLUMN COMPANY.CM_ISCLOSED IS
'Компания закрыта (не показывается в списках)';

COMMENT ON COLUMN CONTACTS.CN_ID IS
'Номер';

COMMENT ON COLUMN CONTACTS.CN_MANAGER IS
'Ответственный, на которого ставится задание';

COMMENT ON COLUMN CONTACTS.CN_OWNER IS
'Следит за обязательством';

COMMENT ON COLUMN CONTACTS.CN_COMPANY IS
'Номер компании';

COMMENT ON COLUMN CONTACTS.CN_PERIODICITY IS
'Периодичность';

COMMENT ON COLUMN CONTACTS.CN_CONTACTER IS
'Контакт в компании по указанному обязательству';

COMMENT ON COLUMN CONTACTS.CN_COMMENT IS
'Комментарий при открытии обязательства';

COMMENT ON COLUMN CONTACTS.CN_COMMENT_CLOSE IS
'Комментарий при закрытии обязательства';

COMMENT ON COLUMN CONTACTS.CN_JOBTYPE IS
'Тип задания выставляемого из автоматической обработки';

COMMENT ON COLUMN CONTACTS.CN_JOBCOMMENT IS
'Комментарий сохраняемый при автоматической обаботке';

COMMENT ON COLUMN CONTACTS.CN_LAST_JOB IS
'ID последнего задания';

COMMENT ON COLUMN CONTACTS.CN_LAST_JOB_DATE IS
'Дата последнего задания';

COMMENT ON COLUMN CONTACTS.CN_NEXT_JOB_DATE IS
'Дата следующего задания';

COMMENT ON COLUMN CONTACTS.CN_ISCLOSED IS
'Закрыто ли обязательство';

COMMENT ON COLUMN CONTACTS.CN_CLOSED_BY_MANAGER IS
'Кем закрыто обязательство';

COMMENT ON COLUMN CONTACTVIEWS.CN_USER IS
'Уникальный номер контакта';

COMMENT ON COLUMN CONTACTVIEWS.CN_VIEWER IS
'Кто может просматривать контакты по задачам';

COMMENT ON COLUMN GRID_SHOW.GS_ID IS
'Ключ и сетчик';

COMMENT ON COLUMN GRID_SHOW.GS_TREEID IS
'Для какой строки дерева действуют правила отображения (NULL - для всех строк)';

COMMENT ON COLUMN GRID_SHOW.GS_FIELD IS
'Имя поля';

COMMENT ON COLUMN GRID_SHOW.GS_HEADER IS
'Что выводить в заголовке';

COMMENT ON COLUMN GRID_SHOW.GS_SHOW IS
'Отображать ли поле';

COMMENT ON COLUMN GRID_SHOW.GS_SIZE IS
'Размер поля в гриде';

COMMENT ON COLUMN GRID_SHOW.GS_DISPLAYFORMAT IS
'Если поле заполнено, то содержит маску вывода';

COMMENT ON COLUMN GRID_SHOW.GS_ORDERBY IS
'Порядок отображения столбцов';

COMMENT ON COLUMN JOBSFORBOSS.JB_JOBID IS
'ID пользователя';

COMMENT ON COLUMN JOBSFORBOSS.JB_VIEWERID IS
'ID пользователя имеющего права на просмотр задания';

COMMENT ON COLUMN PERIODICITY.PR_ID IS
'ID записи';

COMMENT ON COLUMN PERIODICITY.PR_NAME IS
'Комментарий показываемый в программе';

COMMENT ON COLUMN PERIODICITY.PR_COMMENT IS
'Полный комментарий для своих';

COMMENT ON COLUMN PHONES.PH_COMMENT IS
'Контактное лицо телефона';

COMMENT ON COLUMN PHONES.PH_ISCLOSED IS
'Активен (отвечает ли) телефон';

COMMENT ON COLUMN PHONES.PH_DATEEND IS
'Дата закрытия (неактивности) телефона';

COMMENT ON COLUMN PHONES.PH_CLOSEDBY IS
'Кем телефон был закрыт';

COMMENT ON COLUMN PHONES_COMPANIES.PC_PHID IS
'ID телефона';

COMMENT ON COLUMN PHONES_COMPANIES.PC_UID IS
'ID пользователя внесшего контакт';

COMMENT ON COLUMN PHONES_COMPANIES.PC_COMPANY IS
'ID компании';

COMMENT ON COLUMN PHONES_COMPANIES.PC_DATEUPDATE IS
'Дата последнего контакта по указанному телефону';

COMMENT ON COLUMN PRICES_TREE.PT_ID IS
'счетчик и ключ';

COMMENT ON COLUMN PRICES_TREE.PT_PARENTID IS
'К какому родителю принадлежит строка';

COMMENT ON COLUMN PRICES_TREE.PT_VALUE IS
'Наименование ветки дерева';

COMMENT ON COLUMN PRICES_TREE.PT_DATE IS
'Дата когда запись была внесена или обновлена';

COMMENT ON COLUMN PRICES_TREE.PT_ORDERBY IS
'Позиция наименования в дереве, для order by';

COMMENT ON COLUMN PRICES_TREE.PT_ISCLOSED IS
'Запись неактуальна (при отображении прайсов сключить обязательно)';

COMMENT ON COLUMN PRICE_HEADERS.PH_ID IS
'Ключ';

COMMENT ON COLUMN PRICE_HEADERS.PH_COMPANYID IS
'Компания, одна для всех строк прайса';

COMMENT ON COLUMN PRICE_HEADERS.PH_ISFINISHED IS
'Изменения по прайсу завершены';

COMMENT ON COLUMN PRICE_HEADERS.PH_DATE_INSERT IS
'Дата внесения прайса';

COMMENT ON COLUMN PRICE_HEADERS.PH_ISCLOSED IS
'Актуален ли прайс?';

COMMENT ON COLUMN PRICE_LINES.PL_ID IS
'Ключ';

COMMENT ON COLUMN PRICE_LINES.PL_HEADERID IS
'С каким прайсом связано';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE1 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE2 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE3 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE4 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE5 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE6 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE7 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE8 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_VALUE9 IS
'Значение строки прайса';

COMMENT ON COLUMN PRICE_LINES.PL_ORDERBY IS
'Порядок с которым выводятся прайсы';

COMMENT ON COLUMN PRICE_LINES.PL_DATE_UPDATE IS
'Дата записи';

COMMENT ON COLUMN PRICE_LINES.PL_ISCLOSED IS
'Уже не актуально?';

COMMENT ON COLUMN TRUSTLEVEL.TL_ID IS
'ID таблицы';

COMMENT ON COLUMN TRUSTLEVEL.TL_NAME IS
'Уровень доверия';

COMMENT ON COLUMN TRUSTLEVEL.TL_COLOR IS
'Номер цвета (из палитры, число)';

COMMENT ON COLUMN TRUSTLEVEL.TL_LEVEL IS
'Уровень доверия (число)';

COMMENT ON COLUMN TRUSTLEVEL.TL_ISCLOSED IS
'Используется ли';

COMMENT ON COLUMN USERS.U_ID IS
'Уникальный ID ключ таблицы';

COMMENT ON COLUMN USERS.U_LOGIN IS
'Логин';

COMMENT ON COLUMN USERS.U_ISBOSS IS
'Права босса на просмотр';

COMMENT ON COLUMN USERS.U_FIO IS
'Фамилия ИО';

COMMENT ON COLUMN USERS.U_COMMENT IS
'Комментарий о работнике';

COMMENT ON COLUMN USERS.U_ISCLOSED IS
'Закрыт ли данный пользователь';

COMMENT ON COLUMN USERSFORBOSS.UB_USERID IS
'ID пользователя делигирующего права просмотра  (его смотрят)';

COMMENT ON COLUMN USERSFORBOSS.UB_VIEWERID IS
'ID пользователя имеющего права просмотра (он смотрит)';

